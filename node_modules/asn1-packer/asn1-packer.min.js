(function(exports){"use strict";if(!exports.ASN1){exports.ASN1={}}if(!exports.Enc){exports.Enc={}}if(!exports.PEM){exports.PEM={}}var ASN1=exports.ASN1;var Enc=exports.Enc;var PEM=exports.PEM;exports.ASN1=function ASN1(){var args=Array.prototype.slice.call(arguments);var typ=args.shift();var str=args.join("").replace(/\s+/g,"").toLowerCase();var len=str.length/2;var lenlen=0;var hex=typ;if(len!==Math.round(len)){throw new Error("invalid hex")}if(len>127){lenlen+=1;while(len>255){lenlen+=1;len=len>>8}}if(lenlen){hex+=Enc.numToHex(128+lenlen)}return hex+Enc.numToHex(str.length/2)+str};ASN1.UInt=function UINT(){var str=Array.prototype.slice.call(arguments).join("");var first=parseInt(str.slice(0,2),16);if(128&first){str="00"+str}return ASN1("02",str)};ASN1.BitStr=function BITSTR(){var str=Array.prototype.slice.call(arguments).join("");return ASN1("03","00"+str)};ASN1.pack=function(arr){var typ=Enc.numToHex(arr[0]);var str="";if(Array.isArray(arr[1])){arr[1].forEach(function(a){str+=ASN1.pack(a)})}else if("string"===typeof arr[1]){str=arr[1]}else{throw new Error("unexpected array")}if("03"===typ){return ASN1.BitStr(str)}else if("02"===typ){return ASN1.UInt(str)}else{return ASN1(typ,str)}};Object.keys(ASN1).forEach(function(k){exports.ASN1[k]=ASN1[k]});ASN1=exports.ASN1;PEM.packBlock=function(opts){return"-----BEGIN "+opts.type+"-----\n"+Enc.bufToBase64(opts.bytes).match(/.{1,64}/g).join("\n")+"\n"+"-----END "+opts.type+"-----"};Enc.bufToBase64=function(u8){var bin="";u8.forEach(function(i){bin+=String.fromCharCode(i)});return btoa(bin)};Enc.hexToBuf=function(hex){var arr=[];hex.match(/.{2}/g).forEach(function(h){arr.push(parseInt(h,16))});return"undefined"!==typeof Uint8Array?new Uint8Array(arr):arr};Enc.numToHex=function(d){d=d.toString(16);if(d.length%2){return"0"+d}return d}})("undefined"!==typeof window?window:module.exports);
